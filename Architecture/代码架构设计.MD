# 代码架构设计

## 一、数据库和代码的设计
1. 设计目标：自己的服务拥有自己业务的对应代码和数据库，当外部需要自己的数据时暴露接口给外部，实现数据查询
   - 好处：
     - <font color='yellow'>服务解耦与数据自治</font>
       - 独立演进：服务内部数据库结构的调整（如字段变更、分表分库）不会影响外部调用方，只需保持接口兼容性。
       - 技术异构性：不同服务可自由选择适合自身需求的数据库类型（如关系型、文档型、时序数据库）。 
     - <font color='yellow'>安全性增强</font>
       - 最小权限原则：外部服务仅能通过受限的接口访问数据，避免直接暴露数据库（如SQL注入风险）。
       - 集中鉴权：通过API网关或服务间认证（如OAuth、JWT）统一管理权限，而非分散的数据库账号控制。 
     - 数据一致性控制
       - 业务逻辑封装：数据操作（如校验、事务）由服务自身控制，避免外部直接修改导致脏数据。
       - 明确边界：跨服务数据同步通过事件（如消息队列）或API调用显式处理，而非隐式依赖数据库触发器。 
     - <font color='yellow'>性能优化与扩展</font>
       - 接口缓存：可通过HTTP缓存（如Cache-Control）或API网关缓存高频查询结果，减少数据库压力。
       - 读写分离：服务可针对接口需求优化读写策略（如CQRS模式），而无需暴露底层存储细节。 
     - 可观测性与治理
       - 监控与限流：通过接口层（如API网关）监控调用量、延迟和错误率，实施熔断或限流策略。
       - 版本管理：接口版本化升级更可控，避免数据库Schema变更导致全局影响。 
     - 团队协作效率
       - 明确契约：接口文档（如OpenAPI）成为服务间协作的契约，减少跨团队沟通成本。
       - 独立部署：服务与数据库作为一个单元独立部署，降低发布风险。
   - 坏处：
     - 带来了网络开销成本，时延提高
     - 数据冗余问题
2. 



